{"version":3,"file":"vue.js","sources":["../../src/runtime-dom.js","../../src/reactivity.js","../../src/index.js"],"sourcesContent":["// 运行时的包 里面放着dom 操作的方法\nexport const nodeOps = { // 抽离的目的 可以重写这些方法 vue3 自定义渲染器\n    insert(child,parent,anchor){\n        if(anchor){\n            parent.insertBefore(child,anchor);\n        }else{\n            parent.appendChild(child);\n        }\n    },\n    remove(child){\n        const parent = child.parentNode;\n        parent && parent.removeChild(child);\n    },\n    createElement(tag){\n        return document.createElement(tag);\n    },\n    hostSetElementText(el,text){\n        el.textContent = text;\n    },\n    // 属性操作 。。。。\n    hostPatchProps(el,key,prevProps,nextProps){\n        if(/^on[^a-z]/.test(key)){ // 事件   onClick\n            const eventName = key.slice(2).toLowerCase();\n            // 更新事件 // onClick\n            prevProps &&  el.removeEventListener(eventName,prevProps);\n            nextProps && el.addEventListener(eventName,nextProps);\n        }else{\n            // 其他属性\n            if(nextProps == null){\n                return el.removeAttribute(key); // 删除元素上的属性\n            }\n            if(key == 'style'){\n                for(let key in nextProps){\n                    el.style[key] = nextProps[key];\n                }\n                for(let key in prevProps){\n                    if(!nextProps.hasOwnProperty(key)){\n                        el.style[key] = null;\n                    }\n                }\n            }else{ // id class \n                el.setAttribute(key,nextProps) \n            }\n        }\n    }\n}","let activeEffect;\nexport function effect(fn){\n    // 默认effect 需要先执行一次\n    activeEffect = fn; // 存储fn方法  数据变化 需要再次调用这个方法\n    fn();\n    activeEffect = null; // 页面渲染完毕要情空effect\n}\n// 默认只代理第一层\n\n// Reflect.defineProperty()\n// Reflect.ownKeys()\n// Reflect.setPrototypeOf()\nexport function reactive(target){\n    return new Proxy(target,{ // proxy 不用重写每一个属性\n        set(target,key,value,receiver){ // 拦截器 ，性能更高 兼容性差\n            // target[key] = value; //给原来的值做处理\n            const res = Reflect.set(target,key,value,receiver)\n            trigger(target,key); // 触发更新\n            return res;// proxy中set方法需要有返回值\n        },\n        get(target,key,receiver){\n           const res = Reflect.get(target,key,receiver); // target[key]\n           track(target,key); // 依赖收集  只有当我在页面中取值时 才会做依赖收集\n           return res\n        }\n    })\n    // p.a.b.c.d.e\n}\n\n// { map\n//     {name:'zf',age:10}:{\n// \t// map \n// \tname: [effect,effect]  set\n//     }\n// }\n\n// Dep\nconst targetMap = new WeakMap();\nfunction track(target,key){ // target key 多个effect\n    let depsMap = targetMap.get(target);\n    if(!depsMap){\n        targetMap.set(target,(depsMap = new Map()));\n    }\n    let deps = depsMap.get(key);\n    if(!deps){\n        depsMap.set(key,(deps = new Set()));\n    }\n    if(activeEffect && !deps.has(activeEffect)){ // set中有get set  has\n        deps.add(activeEffect);\n    }\n}\nfunction trigger(target,key){\n    const  depsMap = targetMap.get(target);\n    if(!depsMap) return;\n    const effects = depsMap.get(key);\n    effects && effects.forEach(effect=>effect());\n}\n\n// 依赖收集要确定的是 某个属性变了 要更新，而不是整个对象 一个属性要收集对应的effect\n\n\n","import { nodeOps } from './runtime-dom'\nimport { effect } from './reactivity';\nexport * from './reactivity'\nexport function render(vnode, container) {\n    // vue2 渲染页面用的方法叫patch\n    // 1.初次渲染 2.dom-diff\n    patch(container._vnode, vnode, container);\n    container._vnode = vnode; // 上一次渲染的虚拟节点\n}\n/**\n * @param {*} n1  老的虚拟节点\n * @param {*} n2  新的虚拟节点\n * @param {*} container  容器\n */\nfunction patch(n1, n2, container, anchor) { // 后续diff时可以执行此方法\n    // 组件的虚拟节点 tag是一个对象\n    // 如果是组件的话 tag 可能是一个对象\n    if (typeof n2.tag == 'string') {\n        // 标签\n        processElement(n1, n2, container, anchor); // 1） 初次渲染 2） diff操作\n    } else if (typeof n2.tag == 'object') {\n        // 组件\n        mountComponent(n2, container)\n    }\n}\n\nfunction processElement(n1, n2, container, anchor) {\n    if (n1 == null) { //初次渲染\n        mountElement(n2, container, anchor);\n    } else {\n        patchElement(n1, n2, container);\n    }\n}\n\nfunction patchElement(n1, n2, container) {\n    // 看一下 n1 和 n2 是否一样。。。。  考虑key 不考虑没有key的情况\n\n    let el = n2.el = n1.el; // 节点一样就复用\n\n    const oldProps = n1.props;\n    const newProps = n2.props;\n    patchProps(el, oldProps, newProps);\n    // 比对元素中的孩子\n    patchChildren(n1, n2, el);\n}\n\nfunction patchChildren(n1, n2, container) {\n    const c1 = n1.children;\n    const c2 = n2.children;\n    // 可能有多个儿子  另一方没儿子\n\n    if (typeof c2 == 'string') {\n        if (c1 !== c2) { // 直接用问题替换\n            nodeOps.hostSetElementText(container, c2)\n        }\n    } else {\n        // c2 是数组\n        if (typeof c1 == 'string') { // 先删除c1 中原有内容 插入新内容\n            nodeOps.hostSetElementText(container, '');\n            mountChildren(c2, container);\n        } else {\n            patchKeyedChildren(c1, c2, container);\n        }\n    }\n    // 相反\n    // 两方都有儿子\n}\n\nfunction patchKeyedChildren(c1, c2, container) { // key的比较\n    let e1 = c1.length - 1; // 老的最后一项的索引\n    let e2 = c2.length - 1; // 新的最后一项的索引\n\n    // 内部有优化 头头比较   尾尾比较  头尾  尾头\n    const keyedToNewIndexMap = new Map();\n    // 1.根据新节点 生成一个key =》 index的映射表\n    for (let i = 0; i <= e2; i++) {\n        const currentEle = c2[i]; // 拿到这一项\n        keyedToNewIndexMap.set(currentEle.props.key, i);\n    }\n    // 2.去老的里面找 看看有没有对应的  如果有一样的就复用\n\n    const newIndexToOldIndexMap = new Array(e2 + 1); // [-1,-1,-1,-1]\n    for (let i = 0; i <= e2; i++) newIndexToOldIndexMap[i] = -1;\n    for (let i = 0; i <= e1; i++) {\n        const oldVnode = c1[i];\n        // 新的索引\n        let newIndex = keyedToNewIndexMap.get(oldVnode.props.key);\n        if (newIndex == undefined) {\n            // 老的有新的没有\n            nodeOps.remove(oldVnode.el); // 删除老节点\n        } else {\n            // 复用 并且比对属性  因为在算法内部没有考虑值为0的情况\n            newIndexToOldIndexMap[newIndex] = i + 1; // [0,1,-1,-1]\n            patch(oldVnode, c2[newIndex], container); // 递归 比较儿子和标签属性\n\n            console.log(newIndexToOldIndexMap)\n        }\n    }\n    let sequence = getSequence(newIndexToOldIndexMap); // \n    let j = sequence.length - 1; // 获取最后的索引\n    // 以上方法仅仅是比对和删除无用节点 没有移动操作\n    // 这里我们从后往前插入\n    for (let i = e2; i >= 0; i--) {\n        let currentEle = c2[i];\n        const anchor = i + 1 <= e2 ? c2[i + 1].el : null;\n        // 有种可能新的比老的多 有可能新的比老的多 [A,B,C,D] [A,B]\n        if (newIndexToOldIndexMap[i] === -1) {\n            // 这是一个新元素 需要插入到列表中\n            patch(null, currentEle, container, anchor); // 插入到某个人的前面，而不是放到容器的后面\n        } else {\n            // 先将d扔到页面中\n            // 根据最长递增子序列 来确定不需要移动的元素，直接跳过即可\n            if (i == sequence[j]) { // A B C D \n                j--;\n            } else {\n                // 获取不需要移动的 最长个数   \n                nodeOps.insert(currentEle.el, container, anchor);\n            }\n        }\n    }\n    // 3.新的比老的多 添加  老的比新的多就删除\n    // 4.两个人key一样 比较属性，移动\n}\n\nfunction getSequence(arr) { // 最长递增子序列的索引\n    const p = arr.slice()\n    const result = [0]\n    let i, j, u, v, c\n    const len = arr.length\n    for (i = 0; i < len; i++) {\n        const arrI = arr[i]\n        if (arrI !== 0) {\n            j = result[result.length - 1]\n            if (arr[j] < arrI) {\n                p[i] = j\n                result.push(i)\n                continue\n            }\n            u = 0\n            v = result.length - 1\n            while (u < v) {\n                c = ((u + v) / 2) | 0\n                if (arr[result[c]] < arrI) {\n                    u = c + 1\n                } else {\n                    v = c\n                }\n            }\n            if (arrI < arr[result[u]]) {\n                if (u > 0) {\n                    p[i] = result[u - 1]\n                }\n                result[u] = i\n            }\n        }\n    }\n    u = result.length\n    v = result[u - 1]\n    while (u-- > 0) {\n        result[u] = v\n        v = p[v]\n    }\n    return result\n}\n\nfunction patchProps(el, oldProps, newProps) {\n    if (oldProps !== newProps) {\n        // 比较属性\n        // 1.将新的属性 全部设置 以新的为准\n        for (let key in newProps) {\n            const p = oldProps[key];\n            const n = newProps[key];\n            if (n !== p) { // 老的和新的不一样 以新的为准\n                nodeOps.hostPatchProps(el, key, p, n);\n            }\n        }\n        // 2.老的里面有的  新的没有 需要删掉\n        for (const key in oldProps) {\n            if (!newProps.hasOwnProperty(key)) {\n                // 如果老的里面多的得删除掉\n                nodeOps.hostPatchProps(el, key, oldProps[key], null);\n\n            }\n        }\n    }\n}\n\nfunction mountComponent(vnode, container) {\n    // 根据组件创建一个实例\n    const instance = {\n        vnode,\n        render: null, // 当前setup的返回值\n        subTree: null, //render方法的返回的结果\n    }\n    const Component = vnode.tag;\n    instance.render = Component.setup(vnode.props, instance);\n    // 每个组件都有一个effect 用于局部重新渲染\n    effect(() => {\n        // 如果返回的是对象  template =》 render方法 把render方法在挂载到对象上\n        // 这里可以做vue2 兼容 拿到vue2中的options API 和setup的返回值\n        instance.subTree = instance.render && instance.render();\n        patch(null, instance.subTree, container); // 将组件插入到容器中\n    })\n}\n\n\nfunction mountElement(vnode, container, anchor) {\n    const { tag, children, props } = vnode;\n    // 将虚拟节点和真实节点 创造映射关系\n    let el = (vnode.el = nodeOps.createElement(tag));\n    if (props) { // 将当前属性赋予给当前el\n        for (let key in props) {\n            nodeOps.hostPatchProps(el, key, {}, props[key])\n        }\n    }\n\n    if (Array.isArray(children)) {\n        mountChildren(children, el);\n    } else {\n        nodeOps.hostSetElementText(el, children);\n    }\n    nodeOps.insert(el, container, anchor);\n}\n\nfunction mountChildren(children, container) {\n    for (let i = 0; i < children.length; i++) {\n        let child = children[i];\n        patch(null, child, container); // 递归挂载孩子节点\n    }\n}"],"names":["nodeOps","insert","child","parent","anchor","insertBefore","appendChild","remove","parentNode","removeChild","createElement","tag","document","hostSetElementText","el","text","textContent","hostPatchProps","key","prevProps","nextProps","test","eventName","slice","toLowerCase","removeEventListener","addEventListener","removeAttribute","style","hasOwnProperty","setAttribute","activeEffect","effect","fn","reactive","target","Proxy","set","value","receiver","res","Reflect","trigger","get","track","targetMap","WeakMap","depsMap","Map","deps","Set","has","add","effects","forEach","render","vnode","container","patch","_vnode","n1","n2","processElement","mountComponent","mountElement","patchElement","oldProps","props","newProps","patchProps","patchChildren","c1","children","c2","mountChildren","patchKeyedChildren","e1","length","e2","keyedToNewIndexMap","i","currentEle","newIndexToOldIndexMap","Array","oldVnode","newIndex","undefined","console","log","sequence","getSequence","j","arr","p","result","u","v","c","len","arrI","push","n","instance","subTree","Component","setup","isArray"],"mappings":"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"}